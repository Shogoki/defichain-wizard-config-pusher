"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.MessageEncryptor = void 0;
const crypto_js_1 = __importDefault(require("crypto-js"));
const helpers_1 = require("./helpers");
class MessageEncryptor {
    /**
     * Encrypts a certain string data.
     *
     * @param data The string/data to encrypt.
     * @param passphrase The passphrase as string array to encrypt
     * @returns The encrypted string.
     */
    static encrypt(data, passphrase) {
        return crypto_js_1.default.AES.encrypt(data, passphrase.join("")).toString();
    }
    /**
     * Decrypts a certain encryted string and returns the unencrypted string.
     *
     * @param data The string/data to decrypt.
     * @param passphrase The passphrase as string array to decrypt
     * @returns The unencrypted string.
     */
    static decrypt(data, passphrase) {
        let decData = crypto_js_1.default.AES.decrypt((0, helpers_1.removeTXPrefix)(data), passphrase.join(""));
        let bytes = decData.toString(crypto_js_1.default.enc.Utf8);
        return bytes;
    }
}
exports.MessageEncryptor = MessageEncryptor;
